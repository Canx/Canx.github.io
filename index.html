<!DOCTYPE html>
<html>
<head>
<title>Mapa del centre</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
</head>
<body>

<div class="field" style="position: sticky; top: 0px; z-index: 1">
  <label class="label">Mapa del centre</label>
  <div class="control">
    <input id="search-field" class="input search" type="text" />
  </div>
</div>

<div id="lista-centro" class="container">
    <ul class="list"></ul>
</div>

<div style="display:none;">
  <li id="lista-item">
    <h3 class="nombre"></h3>
    <p class="desc"></p>
  </li>
</div>

</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.0.2/list.min.js" integrity="sha512-MT5YyrGWqMGkIbwkVUZEWGrRDjlNx8loukEdFyzLo4s8INKVxnDQy2eFcpmnWGrFwJ+X8mRTQOJpWCayXz7+Og==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script>
var options = {
  item: 'lista-item'
};

var values = [];
var listaCentro = new List('lista-centro', options);

window.googleDocCallback = function () { return true; };

$('#search-field').on('keyup', function() {
  var searchString = $(this).val();
  listaCentro.search(searchString);
});

var seccion = "";
fetch('https://script.google.com/macros/s/AKfycbzluh_D_hAvkd2tGMcD9n8PQNaJ7MZSUyZqNj2Bbr6-jhyp-AS7INum3PpLQcOv7WTjhQ/exec')
  .then(res => res.json())       
  .then((out) => {
        out["data"].forEach(function(elemento) { 
          if (seccion != elemento["seccion"]) {
            values.push({ nombre: elemento["seccion"], desc: "" });
            seccion = elemento["seccion"];
          }
          values.push({ nombre: '<a href="' + elemento["url"] + '">' + elemento["nombre"] + '</a>', desc: elemento["desc"] });
        });
        listaCentro.add(values);
      })
   .catch(err => console.error(err));
</script>
</html>
      
